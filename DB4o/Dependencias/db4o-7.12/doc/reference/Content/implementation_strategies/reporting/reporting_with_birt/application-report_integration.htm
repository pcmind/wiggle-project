<?xml version="1.0" encoding="utf-8"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns:MadCap="http://www.madcapsoftware.com/Schemas/MadCap.xsd" MadCap:lastBlockDepth="2" MadCap:lastHeight="120" MadCap:lastWidth="624" MadCap:disableMasterStylesheet="true" MadCap:tocPath="Implementation Strategies|Reporting|Reporting With BIRT" MadCap:InPreviewMode="false" MadCap:RuntimeFileType="Topic" MadCap:TargetType="WebHelp" MadCap:PathToHelpSystem="../../../../" MadCap:HelpSystemFileName="index.xml" MadCap:SearchType="Stem">
    <head><title>Application-Report Integration	</title>
        <script type="text/javascript">/* <![CDATA[ */
			window.onload = function(){
                             prettyPrint();
			};
                /* ]]> */</script>
        <link href="../../../SkinSupport/MadCap.css" rel="stylesheet" />
        <link href="../../../Resources/Stylesheets/OnlineStyle.css" rel="stylesheet" />
        <script src="../../../Resources/Code/prettify.js">
        </script>
        <script src="../../../Resources/Code/lang-vb.js">
        </script>
        <script src="../../../SkinSupport/MadCapAll.js" type="text/javascript">
        </script>
    </head>
    <body>
        <p class="MCWebHelpFramesetLink" style="display: none;"><a href="../../../../index_CSH.html#implementation_strategies/reporting/reporting_with_birt/application-report_integration.htm" style="">Open topic with navigation</a>
        </p>
        <div class="MCBreadcrumbsBox"><span class="MCBreadcrumbsPrefix">You are here: </span><a class="MCBreadcrumbsLink" href="../../../implementation_strategies.htm">Implementation Strategies</a><span class="MCBreadcrumbsDivider"> &gt; </span><a class="MCBreadcrumbsLink" href="../../reporting.htm">Reporting</a><span class="MCBreadcrumbsDivider"> &gt; </span><a class="MCBreadcrumbsLink" href="../reporting_with_birt.htm">Reporting With BIRT</a><span class="MCBreadcrumbsDivider"> &gt; </span><span class="MCBreadcrumbs">Application-Report Integration</span>
        </div>
        <p>
            <script type="text/javascript">/*<![CDATA[*/document.write('<a href="' + location.href +'">');
				document.write("Direct Link");
			document.write('</a>');/*]]>*/</script>
        </p>
        <p>
        </p>
        <h1>Application-Report Integration</h1>
        <p>The last step is to integrate the existing report into our
java application. This is done with the help of <a href="http://www.eclipse.org/birt/phoenix/deploy/reportEngineAPI.php">Report Engine API</a>.</p>
        <p>Add the libraries from BIRT_HOME/lib to the project. Create
the following method in your main application class:</p>
        <pre class="prettyprint" xml:space="preserve">ReportMain.java: main
public static void main(String[] args) throws BirtException  {
    // create engine configuration
    EngineConfig config = new EngineConfig();
    // specify the path to the BIRT installation 
    config.setEngineHome(BIRT_HOME);
    // set the output directory for the logging and set the logging level
    config.setLogConfig(OUTPUT_DIR, Level.FINE);

    // start the Platform to load the plugins
    Platform.startup(config);
    // create a factory, which will supply ReportEngine instance
    IReportEngineFactory factory = (IReportEngineFactory) Platform
        .createFactoryObject(IReportEngineFactory.EXTENSION_REPORT_ENGINE_FACTORY);
    // there is a significant cost associated with creating a new engine
    // instance, therefore the application should use only one engine instance 
    // for its reports
    engine = factory.createReportEngine(config);
    engine.changeLogLevel(Level.WARNING);

    IReportRunnable design;
    // Open the report design
    design = engine.openReportDesign(REPORT_DESIGN);
    // Create task to run and render the report
    IRunAndRenderTask task = engine.createRunAndRenderTask(design);
    
    // Set rendering options - such as file or stream output,
    // output format, whether it is embeddable, etc
    HTMLRenderOption options = new HTMLRenderOption();
    options.setOutputFileName(OUTPUT_DIR + "//" + REPORT_OUTPUT);
    // output format can be either html or pdf
    options.setOutputFormat("html");
    task.setRenderOption(options);

    // run the report
    task.run();
    task.close();

    // shutdown the engine and the platform after use
    // to clean up and unload the extensions
    engine.shutdown();
    Platform.shutdown();
  }</pre>
        <p>Now you can run the report and check the results in the OUTPUT_DIR folder.</p>
        <p MadCap:conditions="Primary.Online">Download example code:</p>
        <p MadCap:conditions="Primary.Online">
            <MadCap:conditionalText MadCap:conditions="Primary.Java"><a href="reportsbirt.zip">Java</a>
            </MadCap:conditionalText>
        </p>
        <script type="text/javascript" src="../../../SkinSupport/MadCapBodyEnd.js">
        </script>
    </body>
</html>