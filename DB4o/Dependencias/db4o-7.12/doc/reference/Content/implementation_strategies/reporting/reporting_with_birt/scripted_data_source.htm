<?xml version="1.0" encoding="utf-8"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns:MadCap="http://www.madcapsoftware.com/Schemas/MadCap.xsd" MadCap:lastBlockDepth="2" MadCap:lastHeight="120" MadCap:lastWidth="624" MadCap:disableMasterStylesheet="true" MadCap:tocPath="Implementation Strategies|Reporting|Reporting With BIRT" MadCap:InPreviewMode="false" MadCap:RuntimeFileType="Topic" MadCap:TargetType="WebHelp" MadCap:PathToHelpSystem="../../../../" MadCap:HelpSystemFileName="index.xml" MadCap:SearchType="Stem">
    <head><title>Scripted Data Source	</title>
        <script type="text/javascript">/* <![CDATA[ */
			window.onload = function(){
                             prettyPrint();
			};
                /* ]]> */</script>
        <link href="../../../SkinSupport/MadCap.css" rel="stylesheet" />
        <link href="../../../Resources/Stylesheets/OnlineStyle.css" rel="stylesheet" />
        <script src="../../../Resources/Code/prettify.js">
        </script>
        <script src="../../../Resources/Code/lang-vb.js">
        </script>
        <script src="../../../SkinSupport/MadCapAll.js" type="text/javascript">
        </script>
    </head>
    <body>
        <p class="MCWebHelpFramesetLink" style="display: none;"><a href="../../../../index_CSH.html#implementation_strategies/reporting/reporting_with_birt/scripted_data_source.htm" style="">Open topic with navigation</a>
        </p>
        <div class="MCBreadcrumbsBox"><span class="MCBreadcrumbsPrefix">You are here: </span><a class="MCBreadcrumbsLink" href="../../../implementation_strategies.htm">Implementation Strategies</a><span class="MCBreadcrumbsDivider"> &gt; </span><a class="MCBreadcrumbsLink" href="../../reporting.htm">Reporting</a><span class="MCBreadcrumbsDivider"> &gt; </span><a class="MCBreadcrumbsLink" href="../reporting_with_birt.htm">Reporting With BIRT</a><span class="MCBreadcrumbsDivider"> &gt; </span><span class="MCBreadcrumbs">Scripted Data Source</span>
        </div>
        <p>
            <script type="text/javascript">/*<![CDATA[*/document.write('<a href="' + location.href +'">');
				document.write("Direct Link");
			document.write('</a>');/*]]>*/</script>
        </p>
        <p>
        </p>
        <h1>Scripted Data Source</h1>
        <p>At this point we have created the report layout and we've
filled in the data. Now we need to "teach" the report to understand our data
source. We can do this using a script.</p>
        <p>Open Pilots.rptdesign view and select "Script" tag.</p>
        <p>In the Data Explorer window select "Pilot" dataset. Select
"open" script from the drop-down menu in the script window. Add the following
script:</p>
        <p><code>dataClass =
new Packages.Db4oModule();</code>
        </p>
        <p><code>pilots =
dataClass.readData();</code>
        </p>
        <p><code>totalrows =
pilots.size();</code>
        </p>
        <p><code>currentrow =
0; </code>
        </p>
        <p>This script will prepare the data when the report is opened.
Save the changes.</p>
        <p>Select "fetch" script from the drop-down menu. Add the
following script:</p>
        <p><code>row["Pilot"]
= currentrow; </code>
        </p>
        <p><code>row["Points"]
= totalrows; </code>
        </p>
        <p><code>if (currentrow
&gt;= totalrows){ </code>
        </p>
        <p><code>            return(false); </code>
        </p>
        <p><code>}
</code>
        </p>
        <p><code>var pilotsRow
= pilots.get(currentrow); </code>
        </p>
        <p><code>var Pilot =
pilotsRow[0]; </code>
        </p>
        <p><code>var Points =
pilotsRow[1]; </code>
        </p>
        <p><code>row["Pilot"]
= Pilot; </code>
        </p>
        <p><code>row["Points"]
= Points; </code>
        </p>
        <p><code>currentrow =
currentrow + 1; </code>
        </p>
        <p><code>return(true);
</code>
        </p>
        <p>This script fetches the data for the rows in the table.</p>
        <script type="text/javascript" src="../../../SkinSupport/MadCapBodyEnd.js">
        </script>
    </body>
</html>