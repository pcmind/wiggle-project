<?xml version="1.0" encoding="utf-8"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns:MadCap="http://www.madcapsoftware.com/Schemas/MadCap.xsd" MadCap:lastBlockDepth="2" MadCap:lastHeight="120" MadCap:lastWidth="624" MadCap:disableMasterStylesheet="true" MadCap:tocPath="Implementation Strategies|Translators" MadCap:InPreviewMode="false" MadCap:RuntimeFileType="Topic" MadCap:TargetType="WebHelp" MadCap:PathToHelpSystem="../../../" MadCap:HelpSystemFileName="index.xml" MadCap:SearchType="Stem">
    <head><title>Java Translator Implementation	</title>
        <script type="text/javascript">/* <![CDATA[ */
			window.onload = function(){
                             prettyPrint();
			};
                /* ]]> */</script>
        <link href="../../SkinSupport/MadCap.css" rel="stylesheet" />
        <link href="../../Resources/Stylesheets/OnlineStyle.css" rel="stylesheet" />
        <script src="../../Resources/Code/prettify.js">
        </script>
        <script src="../../Resources/Code/lang-vb.js">
        </script>
        <script src="../../SkinSupport/MadCapAll.js" type="text/javascript">
        </script>
    </head>
    <body>
        <p class="MCWebHelpFramesetLink" style="display: none;"><a href="../../../index_CSH.html#implementation_strategies/translators/java_translator_implementation.htm" style="">Open topic with navigation</a>
        </p>
        <div class="MCBreadcrumbsBox"><span class="MCBreadcrumbsPrefix">You are here: </span><a class="MCBreadcrumbsLink" href="../../implementation_strategies.htm">Implementation Strategies</a><span class="MCBreadcrumbsDivider"> &gt; </span><a class="MCBreadcrumbsLink" href="../translators.htm">Translators</a><span class="MCBreadcrumbsDivider"> &gt; </span><span class="MCBreadcrumbs">Java Translator Implementation</span>
        </div>
        <p>
            <script type="text/javascript">/*<![CDATA[*/document.write('<a href="' + location.href +'">');
				document.write("Direct Link");
			document.write('</a>');/*]]>*/</script>
        </p>
        <p>
        </p>
        <h1>Java Translator Implementation</h1>
        <p MadCap:conditions="Primary.Java,Primary.All languages">
            <p>To
translate NotStorable instances, we will pack their id and name values
into an Object array to be stored and retrieve it from there again.
Note that we don't have to do any work in onActivate(), since object
reinstantiation is already fully completed in onInstantiate().</p>
            <pre class="prettyprint" xml:space="preserve">NotStorableTranslator.java
/**//* Copyright (C) 2004 - 2007 Versant Inc. http://www.db4o.com */
package com.db4odoc.translators;

import com.db4o.*;
import com.db4o.config.*;

public class NotStorableTranslator implements ObjectConstructor  {
  public Object onStore(ObjectContainer container,
      Object applicationObject)  {
    System.out.println("onStore for " + applicationObject);
    NotStorable notStorable = (NotStorable) applicationObject;
    return new Object[]  { new Integer(notStorable.getId()),
        notStorable.getName() };
  }

  public Object onInstantiate(ObjectContainer container,
      Object storedObject)  {
    System.out.println("onInstantiate for " + storedObject);
    Object[] raw = (Object[]) storedObject;
    int id = ((Integer) raw[0]).intValue();
    String name = (String) raw[1];
    return new NotStorable(id, name);
  }

  public void onActivate(ObjectContainer container,
      Object applicationObject, Object storedObject)  {
    System.out.println("onActivate for " + applicationObject
        + " / " + storedObject);
  }

  public Class storedClass()  {
    return Object[].class;
  }
}</pre>
            <p>Let's try it out:</p>
            <pre class="prettyprint" xml:space="preserve">TranslatorExample.java: storeWithTranslator
private static void storeWithTranslator()  {
    Configuration configuration = Db4o.newConfiguration();
    configuration.objectClass(NotStorable.class).translate(
        new NotStorableTranslator());
    tryStoreAndRetrieve(configuration);
  }</pre>
        </p>
        <p MadCap:conditions="Global.Primary:java" />
        <p>ObjectTranslators let you reconfigure the state of a 'blank' application object reinstantiated by 
db4o, ObjectConstructors also take care of instantiating the
application object itself. ObjectTranslators and ObjectConstructors can
be used for classes that cannot cleanly be stored and retrieved with
db4o's standard object instantiation mechanisms. 
</p>
        <p MadCap:conditions="Primary.Online">Download example code:</p>
        <p MadCap:conditions="Primary.Online">
            <MadCap:conditionalText MadCap:conditions="Primary.Java"><a href="translatorsjava.zip">Java </a>
            </MadCap:conditionalText>
        </p>
        <script type="text/javascript" src="../../SkinSupport/MadCapBodyEnd.js">
        </script>
    </body>
</html>