<?xml version="1.0" encoding="utf-8"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns:MadCap="http://www.madcapsoftware.com/Schemas/MadCap.xsd" MadCap:lastBlockDepth="2" MadCap:lastHeight="120" MadCap:lastWidth="624" MadCap:disableMasterStylesheet="true" MadCap:tocPath="Implementation Strategies|Maintenance" MadCap:InPreviewMode="false" MadCap:RuntimeFileType="Topic" MadCap:TargetType="WebHelp" MadCap:PathToHelpSystem="../../../" MadCap:HelpSystemFileName="index.xml" MadCap:SearchType="Stem">
    <head><title>Updating Db4o File Format	</title>
        <script type="text/javascript">/* <![CDATA[ */
			window.onload = function(){
                             prettyPrint();
			};
                /* ]]> */</script>
        <link href="../../SkinSupport/MadCap.css" rel="stylesheet" />
        <link href="../../Resources/Stylesheets/OnlineStyle.css" rel="stylesheet" />
        <script src="../../Resources/Code/prettify.js">
        </script>
        <script src="../../Resources/Code/lang-vb.js">
        </script>
        <script src="../../SkinSupport/MadCapAll.js" type="text/javascript">
        </script>
    </head>
    <body>
        <p class="MCWebHelpFramesetLink" style="display: none;"><a href="../../../index_CSH.html#implementation_strategies/maintenance/updating_db4o_file_format.htm" style="">Open topic with navigation</a>
        </p>
        <div class="MCBreadcrumbsBox"><span class="MCBreadcrumbsPrefix">You are here: </span><a class="MCBreadcrumbsLink" href="../../implementation_strategies.htm">Implementation Strategies</a><span class="MCBreadcrumbsDivider"> &gt; </span><a class="MCBreadcrumbsLink" href="../maintenance.htm">Maintenance</a><span class="MCBreadcrumbsDivider"> &gt; </span><span class="MCBreadcrumbs">Updating db4o File Format</span>
        </div>
        <p>
            <script type="text/javascript">/*<![CDATA[*/document.write('<a href="' + location.href +'">');
				document.write("Direct Link");
			document.write('</a>');/*]]>*/</script>
        </p>
        <p>
        </p>
        <h1>Updating Db4o File Format</h1>
        <p>The db4o database file format is a subject to change to
allow progress for performance and additional features.  
 
db4o does not support downgrades back to previous versions of database files.  
 
In order to prevent accidental upgrades when using different db4o versions or
ObjectManager, db4o does not upgrade databases by default.  
 
Database upgrading can be turned on with the following configuration switch: </p>
        <p MadCap:conditions="Primary.Java,Primary.All languages">
            <p>Java: </p>
            <p><code>Db4o.configure().allowVersionUpdates(true) </code>
            </p>
        </p>
        <p MadCap:conditions="Global.Primary:java" />
        <p MadCap:conditions="Global.Primary:cs" />
        <p MadCap:conditions="Global.Primary:vb" />
        <p>Please note that, once the database file version is updated, there is no way to
get back to the older version of the database file  
 
If a database file is opened successfully with the new db4o version, the
upgrade of the file will take place automatically. You can simply upgrade
database files by opening and closing a db4o database once with code like the
following:  </p>
        <p MadCap:conditions="Primary.Java,Primary.All languages">
            <pre class="prettyprint" xml:space="preserve">UpdateExample.java
/**//* Copyright (C) 2007 Versant Inc. http://www.db4o.com */

package com.db4odoc.versionupdate;

import com.db4o.Db4o;
import com.db4o.ObjectContainer;

public class UpdateExample  {

  public static void main(String[] args)  {
    Db4o.configure().allowVersionUpdates(true);
    ObjectContainer objectContainer = Db4o.openFile(args[0]);
    objectContainer.close();
    System.out.println("The database is ready for the version " + Db4o.version());
  }

}</pre>
        </p>
        <p MadCap:conditions="Global.Primary:java" />
        <p MadCap:conditions="Global.Primary:cs" />
        <p MadCap:conditions="Global.Primary:vb" />Recommendations for upgrading:  <ul><li value="1">backup your database file to be able to switch back. </li><li value="2">check the content of database files before and after upgrading, using
com.db4o.tools.Statistics. </li><li value="3"><a href="defragment.htm">Defragmenting</a> a database file with the new db4o version
after upgrading can make the database more efficient.

</li></ul><p MadCap:conditions="Primary.Online">Download example code:</p><p MadCap:conditions="Primary.Online"><MadCap:conditionalText MadCap:conditions="Primary.Java"><a href="versionupdatesjava.zip">Java </a></MadCap:conditionalText></p><script type="text/javascript" src="../../SkinSupport/MadCapBodyEnd.js"></script></body>
</html>