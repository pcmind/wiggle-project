<?xml version="1.0" encoding="utf-8"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns:MadCap="http://www.madcapsoftware.com/Schemas/MadCap.xsd" MadCap:lastBlockDepth="2" MadCap:lastHeight="120" MadCap:lastWidth="624" MadCap:disableMasterStylesheet="true" MadCap:tocPath="Working With Source Code" MadCap:InPreviewMode="false" MadCap:RuntimeFileType="Topic" MadCap:TargetType="WebHelp" MadCap:PathToHelpSystem="../../" MadCap:HelpSystemFileName="index.xml" MadCap:SearchType="Stem">
    <head><title>Sharpen Set-Up For Db4o Build	</title>
        <script type="text/javascript">/* <![CDATA[ */
			window.onload = function(){
                             prettyPrint();
			};
                /* ]]> */</script>
        <link href="../SkinSupport/MadCap.css" rel="stylesheet" />
        <link href="../Resources/Stylesheets/OnlineStyle.css" rel="stylesheet" />
        <script src="../SkinSupport/MadCapAll.js">
        </script>
        <script src="../Resources/Code/prettify.js">
        </script>
        <script src="../Resources/Code/lang-vb.js">
        </script>
    </head>
    <body>
        <p class="MCWebHelpFramesetLink" style="display: none;"><a href="../../index_CSH.html#working_with_source_code/sharpen_set-up_for_db4o_build.htm" style="">Open topic with navigation</a>
        </p>
        <div class="MCBreadcrumbsBox"><span class="MCBreadcrumbsPrefix">You are here: </span><a class="MCBreadcrumbsLink" href="../working_with_source_code.htm">Working With Source Code</a><span class="MCBreadcrumbsDivider"> &gt; </span><span class="MCBreadcrumbs">Sharpen Set-Up For Db4o Build	</span>
        </div>
        <p>
            <script type="text/javascript">/*<![CDATA[*/document.write('<a href="' + location.href +'">');
				document.write("Direct Link");
			document.write('</a>');/*]]>*/</script>
        </p>
        <p>
        </p>
        <h1>Sharpen Set-Up For Db4o Build</h1>
        <p><span class="MCPopup"><a href="javascript:void(0);" class="MCPopupSpot" onclick="FMCPopup( event, this ); return false;" MadCap:src="../sharpen.htm">Sharpen<img style="border: none;margin-left: 5px;" src="../SkinSupport/ExpandingClosed.gif" MadCap:altsrc="../SkinSupport/ExpandingOpen.gif" class="MCExpandingIcon" onload="if ( typeof( FMCPreloadImage ) == 'function' ) { FMCPreloadImage( '../SkinSupport/ExpandingOpen.gif' ); }" /></a></span> is used to translate Java version of db4o to c#. The
basic process is defined in <b>sharpen-all</b>target of <b>db4obuild\build-dotnet.xml</b>.
In the primitive case defining sharpen task and applying it to java source
should be enough:</p>
        <pre class="prettyprint" xml:space="preserve">
            <a name="kanchor194"></a>Sharpen.Xml
&lt;!-- Define sharpen task--&gt;
  &lt;macrodef name="sharpen"&gt;
    &lt;attribute name="workspace" /&gt;
    &lt;attribute name="resource" /&gt;
    
    &lt;element name="args" optional="yes" /&gt;
    
    &lt;sequential&gt;
      &lt;echo&gt;java -cp ${eclipse.startup.jar} 
org.eclipse.core.launcher.Main -data @{workspace} -application 
sharpen.core.application @{resource}&lt;/echo&gt;
      &lt;exec executable="${file.jvm.jdk1.5}" failonerror="true" 
timeout="1800000"&gt;
        &lt;arg value="-Xms256m" /&gt;
        &lt;arg value="-Xmx512m" /&gt;
        &lt;arg value="-cp" /&gt;
        &lt;arg value="${eclipse.startup.jar}" /&gt;
        &lt;arg value="org.eclipse.core.launcher.Main" /&gt;
        &lt;arg value="-data" /&gt;
        &lt;arg file="@{workspace}" /&gt;
        &lt;arg value="-application" /&gt;
        &lt;arg value="sharpen.core.application" /&gt;
        &lt;arg value="-header" /&gt;
        &lt;arg file="${dir.config}/copyright_comment.txt" /&gt;
        &lt;arg value="@{resource}" /&gt;
        
        &lt;args /&gt;
        
      &lt;/exec&gt;
    &lt;/sequential&gt;
  &lt;/macrodef&gt;

    &lt;!-- Call sharpen to convert db4oj/core/src into dist.sharpen --&gt; 
  &lt;sharpen workspace="dist.sharpen" resource="db4oj/core/src" /&gt;</pre>
        <p>However, the complexity of the translation requires some
fine tuning. Let's look at the options and annotations used to make db4o
conversion working and produce a reasonable result.</p><a name="Conversion Scope"></a>
        <h2>Conversion Scope</h2>
        <p>Though Sharpen provides rather sophisticated framework, some
of the java language structures cannot be translated to c# without losing some
of the readability and nativeness of the c# code. One of the examples is IO
API. In these cases a full c# class is re-written manually. These classes are
excluded from the conversion by using @sharpen.ignore annotation. However this
solves only half of the problem, because the manually-translated classes still
should be placed correctly in the corresponding namespaces. This is achieved by
creating a c# project structure containing only manually translated classes.
The result of the sharpening is then copied into this structure, resulting in a
full and valid c# project.</p><a name="Naming"></a>
        <h2>Naming</h2>
        <p>Naming conventions differ for java and c#, but db4o code
should look native in both environments. There are several options that help to
achieve this:</p>
        <p><code>-pascalCase+</code> - enforces Pascal case for identifies and
namespaces</p>
        <p><code>-nativeTypeSystem</code> - use .NET typesystem</p>
        <p><code>-nativeInterfaces</code> - add "I" in front of the interface name</p>
        <p>Sharpen options also include different re-namings to make c#
names look more natural:</p>
        <p><code>-typeMapping com.db4o.Db4o Db4objects.Db4o.Db4oFactory</code>
        </p>
        <p><code>-namespaceMapping com.db4o Db4objects.Db4o</code>
        </p>
        <p>and others.</p>
        <p>c# supports a concept of type properties whereas Java getter
and setter methods are used. To convert those properly propertyMapping option
is defined:</p>
        <p><code>-propertyMapping com.db4o.foundation.Iterator4.current
Current</code>
        </p>
        <p>For more information on these and other options see <a href="../sharpen/sharpen_command-line_arguments.htm">Sharpen Command-Line Arguments</a>.</p>
        <script type="text/javascript" src="../SkinSupport/MadCapBodyEnd.js">
        </script>
    </body>
</html>