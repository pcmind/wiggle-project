<?xml version="1.0" encoding="utf-8"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns:MadCap="http://www.madcapsoftware.com/Schemas/MadCap.xsd" MadCap:lastBlockDepth="2" MadCap:lastHeight="120" MadCap:lastWidth="624" MadCap:disableMasterStylesheet="true" MadCap:tocPath="Tuning|Native Query Optimization" MadCap:InPreviewMode="false" MadCap:RuntimeFileType="Topic" MadCap:TargetType="WebHelp" MadCap:PathToHelpSystem="../../../" MadCap:HelpSystemFileName="index.xml" MadCap:SearchType="Stem">
    <head><title>Monitoring Optimization	</title>
        <script type="text/javascript">/* <![CDATA[ */
			window.onload = function(){
                             prettyPrint();
			};
                /* ]]> */</script>
        <link href="../../SkinSupport/MadCap.css" rel="stylesheet" />
        <link href="../../Resources/Stylesheets/OnlineStyle.css" rel="stylesheet" />
        <script src="../../Resources/Code/prettify.js">
        </script>
        <script src="../../Resources/Code/lang-vb.js">
        </script>
        <script src="../../SkinSupport/MadCapAll.js" type="text/javascript">
        </script>
    </head>
    <body>
        <p class="MCWebHelpFramesetLink" style="display: none;"><a href="../../../index_CSH.html#tuning/native_query_optimization/monitoring_optimization.htm" style="">Open topic with navigation</a>
        </p>
        <div class="MCBreadcrumbsBox"><span class="MCBreadcrumbsPrefix">You are here: </span><a class="MCBreadcrumbsLink" href="../../tuning.htm">Tuning</a><span class="MCBreadcrumbsDivider"> &gt; </span><a class="MCBreadcrumbsLink" href="../native_query_optimization.htm">Native Query Optimization</a><span class="MCBreadcrumbsDivider"> &gt; </span><span class="MCBreadcrumbs">Monitoring Optimization</span>
        </div>
        <p>
            <script type="text/javascript">/*<![CDATA[*/document.write('<a href="' + location.href +'">');
				document.write("Direct Link");
			document.write('</a>');/*]]>*/</script>
        </p>
        <p>
        </p>
        <h1><a name="kanchor152"></a>Monitoring Optimization</h1>
        <p>This feature is not complete and can only be used for experiments </p>
        <p>Currently you can only attach a listener to the <MadCap:conditionalText MadCap:conditions="Primary.Java">ObjectContainer</MadCap:conditionalText>:</p>
        <pre class="prettyprint" xml:space="preserve">NQExample.java: nqListener
public static void nqListener()  {
    ObjectContainer db = Db4o.openFile(DBFILENAME);
    ((InternalObjectContainer)db).getNativeQueryHandler().addListener(
        new Db4oQueryExecutionListener()  {
          public void notifyQueryExecuted(NQOptimizationInfo info)  {
            System.err.println(info);
          }
        });
  }</pre>
        <p>The listener will be notified on each native query call and will be passed the Predicate object processed, the optimized expression tree (if successful) and the success status of the optimization run:</p>
        <p><code>ObjectContainerBase.UNOPTIMIZED ("UNOPTIMIZED")</code>
        </p>
        <p>if the predicate could not be optimized and is run in unoptimized mode</p>
        <p><code>ObjectContainerBase.PREOPTIMIZED ("PREOPTIMIZED")</code>
        </p>
        <p>if the predicate already was optimized (due to class file or load time instrumentation)</p>
        <p><code>ObjectContainerBase.DYNOPTIMIZED ("DYNOPTIMIZED")</code>
        </p>
        <p>if the predicate was optimized at query execution time</p>
        <p MadCap:conditions="Primary.Online">Download example code:</p>
        <p MadCap:conditions="Primary.Online">
            <MadCap:conditionalText MadCap:conditions="Primary.Java"><a href="nqoptimizationjava.zip">Java </a>
            </MadCap:conditionalText>
        </p>
        <script type="text/javascript" src="../../SkinSupport/MadCapBodyEnd.js">
        </script>
    </body>
</html>